
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/cifar10_gpu.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_cifar10_gpu.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_cifar10_gpu.py:


"This" is my example-script
===========================

This example doesn't do much, it just makes a simple plot

.. GENERATED FROM PYTHON SOURCE LINES 7-51

.. code-block:: default
   :lineno-start: 9



    import sys

    import ray
    import torch

    sys.path.insert(0, '../..')
    from blades.simulator import Simulator
    from blades.datasets import CIFAR10
    from blades.models.cifar10 import CCTNet

    cifar10 = CIFAR10(num_clients=20, iid=True)  # built-in federated cifar10 dataset

    # configuration parameters
    conf_params = {
        "dataset": cifar10,
        "aggregator": "krum",  # defense: robust aggregation
        "num_byzantine": 5,  # number of byzantine input
        "use_cuda": True,
        "attack": "noise",  # attack strategy
        # "attack_para":{"n": 20, # attacker parameters
        #                "m": 5},
        "num_actors": 20,  # number of training actors
        "gpu_per_actor": 0.19,
        "seed": 1,  # reproducibility
    }

    ray.init(num_gpus=4)
    simulator = Simulator(**conf_params)

    model = CCTNet()
    server_opt = torch.optim.Adam(model.parameters(), lr=0.01)
    # runtime parameters
    run_params = {
        "model": model,  # global model
        "server_optimizer": server_opt,  # 'SGD',  # server optimizer
        "client_optimizer": 'SGD',  # client optimizer
        "loss": "crossentropy",  # loss function
        "global_rounds": 400,  # number of global rounds
        "local_steps": 10,  # number of s"client_lr": 0.1,  # learning rateteps per round
    
    }
    simulator.run(**run_params)


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.000 seconds)


.. _sphx_glr_download_auto_examples_cifar10_gpu.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: cifar10_gpu.py <cifar10_gpu.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: cifar10_gpu.ipynb <cifar10_gpu.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
